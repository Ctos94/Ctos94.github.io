import{_ as e,A as t,r as s,o as l,e as a,w as i,b as r,v as o,f as n,c as d,F as u}from"./index-b6422c35.js";const m=e({data:()=>({loading:!1,tableHeaders:[{title:"用户名",key:"username",sortable:!1},{key:"actions",width:100,align:"center",sortable:!1}],users:[]}),components:{RoleUserDialog:e({data:()=>({loading:!1,visible:!1,username:""}),props:{role_id:{type:String,required:!0}},methods:{async submit(){const{valid:e}=await this.$refs.form.validate();e&&(this.loading=!0,this.$request.post({url:t.system.role.add_user,params:{roleId:this.role_id,username:this.username}}).then((()=>{this.visible=!1,this.$emit("callback")})).finally((()=>{this.loading=!1})))}}},[["render",function(e,t,d,u,m,c){const h=s("v-btn"),v=s("v-text-field"),b=s("v-card-text"),f=s("v-spacer"),g=s("v-btn-text"),p=s("v-card-actions"),y=s("v-card"),_=s("v-form"),k=s("v-dialog");return l(),a(k,{modelValue:m.visible,"onUpdate:modelValue":t[3]||(t[3]=e=>m.visible=e),"max-width":"300"},{activator:i((({props:e})=>[r(h,o({color:"blue-lighten-1",text:"添加用户"},e),null,16)])),default:i((()=>[r(_,{class:"form",onSubmit:t[2]||(t[2]=n((()=>{}),["prevent"])),ref:"form"},{default:i((()=>[r(y,null,{default:i((()=>[r(b,null,{default:i((()=>[r(v,{label:"用户名",rules:[e.$validator.required],modelValue:m.username,"onUpdate:modelValue":t[0]||(t[0]=e=>m.username=e)},null,8,["rules","modelValue"])])),_:1}),r(p,null,{default:i((()=>[r(f),r(g,{text:"取消",onClick:t[1]||(t[1]=e=>m.visible=!1)}),r(g,{color:"primary",disabled:m.loading,loading:m.loading,text:"保存",onClick:c.submit},null,8,["disabled","loading","onClick"])])),_:1})])),_:1})])),_:1},512)])),_:1},8,["modelValue"])}]])},mounted(){this.$store.commit("update_sider_active","/system/roles"),this.requestUsers()},methods:{requestUsers(){this.loading=!0,this.$request.get({url:t.system.role.users,params:{roleId:this.$route.query.id}}).then((e=>{this.users=e})).finally((()=>{this.loading=!1}))},del(e){this.$confirm({message:"确定要删除吗？"}).then((()=>{this.$request.delete({url:t.system.role.del_user,data:{userId:e}}).then((()=>{this.requestUsers()}))})).catch((()=>{}))}}},[["render",function(e,t,a,o,n,m){const c=s("v-btn-text"),h=s("RoleUserDialog"),v=s("v-btn-link"),b=s("v-data-table-virtual");return l(),d(u,null,[r(c,{style:{"margin-right":"10px"},onClick:t[0]||(t[0]=e=>this.$router.push("/system/roles")),icon:"mdi-chevron-left"}),r(h,{onCallback:m.requestUsers,role_id:this.$route.query.id},null,8,["onCallback","role_id"]),r(b,{headers:n.tableHeaders,items:n.users},{"item.actions":i((({item:e})=>[r(v,{onClick:t=>m.del(e.id),text:"删除"},null,8,["onClick"])])),_:1},8,["headers","items"])],64)}]]);export{m as default};
