import{_ as t,A as e,y as a,r as l,o as r,e as s,w as i,b as u,a as n,u as o,k as d,j as c,q as m,l as f,x as p,H as h,h as v,t as y,G as _,s as g}from"./index-749c2d1b.js";import{P as b}from"./PriceFormat-6ccd47a6.js";import{_ as x}from"./Chart-c5584566.js";const $=t({components:{Chart:x},props:{year:{default:null}},data:()=>({}),mounted(){},methods:{request:function(){let t=this.$refs.chart.chart;this.$request.get({url:e.bill.statistic.month,params:{year:this.year},loading:{target:"#chart"}}).then((e=>{let l=e.map((t=>t.price));t.setOption({tooltip:{trigger:"axis",formatter:function(t,e,l){return`${t[0].axisValue}月: ${a(t[0].data)}`}},xAxis:{type:"category",data:[1,2,3,4,5,6,7,8,9,10,11,12]},yAxis:{type:"value"},series:[{data:l,type:"line",markLine:{silent:!0,lineStyle:{color:"rgba(193, 65, 65, 1)"},data:[{type:"average",name:"Avg"}]}}]})}))}},watch:{year:function(t){this.request()}}},[["render",function(t,e,a,o,d,c){const m=l("v-card-title"),f=x,p=l("v-card-text"),h=l("v-card"),v=l("v-sheet");return r(),s(v,{id:"chart",border:"",rounded:""},{default:i((()=>[u(h,{flat:""},{default:i((()=>[u(m,null,{default:i((()=>[n(" 月支出 ")])),_:1}),u(p,null,{default:i((()=>[u(f,{ref:"chart"},null,512)])),_:1})])),_:1})])),_:1})}]]);const q=t({components:{Chart:x},props:{year:{default:null}},data:()=>({}),mounted(){},methods:{request:function(){let t=this.$refs.chart.chart;this.$request.get({url:e.bill.statistic.classify,params:{year:this.year},loading:{target:"#pie_chart"}}).then((e=>{let l=e.map((t=>({name:t.tag,value:t.price})));t.setOption({tooltip:{trigger:"item",formatter:function(t,e,l){return`${t.name}: ${a(t.value)} (${t.percent}%)`}},series:[{type:"pie",radius:["40%","70%"],itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},data:l}]})}))}},watch:{year:function(t){this.request()}}},[["render",function(t,e,a,o,d,c){const m=l("v-card-title"),f=x,p=l("v-card-text"),h=l("v-card"),v=l("v-sheet");return r(),s(v,{id:"pie_chart",border:"",rounded:""},{default:i((()=>[u(h,{flat:""},{default:i((()=>[u(m,null,{default:i((()=>[n("分类支出")])),_:1}),u(p,null,{default:i((()=>[u(f,{ref:"chart"},null,512)])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-84c76b62"]]),w={__name:"Statistics",setup(t){const a=o(),x=d(void 0),w=d(void 0),j=d(0);return c((()=>{a.commit("update_sider_active","/bill/statistics")})),m((()=>{f.get({url:e.bill.statistic.years,loading:{target:"#statistics"}}).then((t=>{t&&t.length>0&&(w.value=t,p((()=>{x.value=w.value[0]})))}))})),h(x,(()=>{f.get({url:e.bill.statistic.price,params:{year:x.value}}).then((t=>{j.value=t||0}))})),(t,e)=>{const a=l("v-list-item"),o=l("v-select"),d=l("v-sheet"),c=l("v-col"),m=l("v-row");return r(),s(d,{id:"statistics"},{default:i((()=>[u(d,null,{default:i((()=>[u(d,{class:"d-flex align-end"},{default:i((()=>[u(d,{width:"130px"},{default:i((()=>[u(o,{density:"compact",variant:"outlined","hide-details":"",items:w.value,modelValue:x.value,"onUpdate:modelValue":e[0]||(e[0]=t=>x.value=t)},{selection:i((({item:t})=>[v("span",null,y(t.title)+"年",1)])),item:i((({props:t,item:e})=>[u(a,_(t,{title:`${e.title}年`}),null,16,["title"])])),_:1},8,["items","modelValue"])])),_:1}),j.value?(r(),s(d,{key:0,class:"ml-2"},{default:i((()=>[n("总支出 "),u(b,{size:24,amount:j.value},null,8,["amount"])])),_:1})):g("",!0)])),_:1}),u(m,{class:"mt-0"},{default:i((()=>[u(c,{cols:"7",class:"pr-0"},{default:i((()=>[u($,{year:x.value},null,8,["year"])])),_:1}),u(c,{cols:"5"},{default:i((()=>[u(q,{year:x.value},null,8,["year"])])),_:1})])),_:1})])),_:1})])),_:1})}}};export{w as default};
