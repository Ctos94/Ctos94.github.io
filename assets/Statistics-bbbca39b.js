import{_ as t,A as e,r as a,o as r,e as i,w as s,b as l,a as n,h as u,t as o,v as c,l as d}from"./index-b6422c35.js";import{P as h}from"./PriceFormat-60cb5ef6.js";import{_ as m}from"./Chart-9ebf97d0.js";import{f}from"./common-5afeacdf.js";const p=t({components:{PriceFormatVue:h,ChartLine:t({components:{Chart:m},props:{year:{default:null}},data:()=>({}),mounted(){},methods:{request:function(){let t=this.$refs.chart.chart;this.$request.get({url:e.bill.statistic.month,params:{year:this.year},loading:{target:"#chart"}}).then((e=>{let a=e.map((t=>t.price));t.setOption({tooltip:{trigger:"axis",formatter:function(t,e,a){return`${t[0].axisValue}月: ${f(t[0].data)}`}},xAxis:{type:"category",data:[1,2,3,4,5,6,7,8,9,10,11,12]},yAxis:{type:"value"},series:[{data:a,type:"line",markLine:{silent:!0,lineStyle:{color:"rgba(193, 65, 65, 1)"},data:[{type:"average",name:"Avg"}]}}]})}))}},watch:{year:function(t){this.request()}}},[["render",function(t,e,u,o,c,d){const h=a("v-card-title"),f=m,p=a("v-card-text"),y=a("v-card"),_=a("v-sheet");return r(),i(_,{id:"chart",border:"",rounded:""},{default:s((()=>[l(y,{flat:""},{default:s((()=>[l(h,null,{default:s((()=>[n(" 月支出 ")])),_:1}),l(p,null,{default:s((()=>[l(f,{ref:"chart"},null,512)])),_:1})])),_:1})])),_:1})}]]),ChartPie:t({components:{Chart:m},props:{year:{default:null}},data:()=>({}),mounted(){},methods:{request:function(){let t=this.$refs.chart.chart;this.$request.get({url:e.bill.statistic.classify,params:{year:this.year},loading:{target:"#pie_chart"}}).then((e=>{let a=e.map((t=>({name:t.tag,value:t.price})));t.setOption({tooltip:{trigger:"item",formatter:function(t,e,a){return`${t.name}: ${f(t.value)} (${t.percent}%)`}},series:[{type:"pie",radius:["40%","70%"],itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},data:a}]})}))}},watch:{year:function(t){this.request()}}},[["render",function(t,e,u,o,c,d){const h=a("v-card-title"),f=m,p=a("v-card-text"),y=a("v-card"),_=a("v-sheet");return r(),i(_,{id:"pie_chart",border:"",rounded:""},{default:s((()=>[l(y,{flat:""},{default:s((()=>[l(h,null,{default:s((()=>[n("分类支出")])),_:1}),l(p,null,{default:s((()=>[l(f,{ref:"chart"},null,512)])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-84c76b62"]])},data:()=>({current_year:void 0,years:void 0,price:0}),beforeMount(){this.$store.commit("update_sider_active","/bill/statistics")},mounted(){this.$request.get({url:e.bill.statistic.years,loading:{target:"#statistics"}}).then((t=>{t&&t.length>0&&(this.years=t,this.$nextTick((()=>{this.current_year=this.years[0]})))}))},methods:{getPrice:function(){this.$request.get({url:e.bill.statistic.price,params:{year:this.current_year}}).then((t=>{this.price=t||0}))}},watch:{current_year:function(t){this.getPrice()}}},[["render",function(t,e,h,m,f,p){const y=a("v-list-item"),_=a("v-select"),v=a("v-sheet"),g=a("PriceFormatVue"),b=a("ChartLine"),$=a("v-col"),x=a("ChartPie"),q=a("v-row");return r(),i(v,{id:"statistics"},{default:s((()=>[l(v,null,{default:s((()=>[l(v,{class:"d-flex align-end"},{default:s((()=>[l(v,{width:"130px"},{default:s((()=>[l(_,{density:"compact",variant:"outlined","hide-details":"",items:f.years,modelValue:f.current_year,"onUpdate:modelValue":e[0]||(e[0]=t=>f.current_year=t)},{selection:s((({item:t})=>[u("span",null,o(t.title)+"年",1)])),item:s((({props:t,item:e})=>[l(y,c(t,{title:`${e.title}年`}),null,16,["title"])])),_:1},8,["items","modelValue"])])),_:1}),this.price?(r(),i(v,{key:0,class:"ml-2"},{default:s((()=>[n("总支出 "),l(g,{size:24,amount:f.price},null,8,["amount"])])),_:1})):d("",!0)])),_:1}),l(q,{class:"mt-0"},{default:s((()=>[l($,{cols:"7",class:"pr-0"},{default:s((()=>[l(b,{year:f.current_year},null,8,["year"])])),_:1}),l($,{cols:"5"},{default:s((()=>[l(x,{year:f.current_year},null,8,["year"])])),_:1})])),_:1})])),_:1})])),_:1})}]]);export{p as default};
