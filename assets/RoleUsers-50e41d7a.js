import{k as e,r as l,o as a,c as t,a as r,w as s,f as u,F as o,l as n,A as i,P as d,u as v,q as c,t as m,$ as _}from"./index-3aa48a50.js";const f={__name:"RoleUserDialog",props:{role_id:{type:String,required:!0}},emits:["callback"],setup(d,{emit:v}){const c=e(!1),m=e(!1),_=e(""),f=e(null),p=d,y=v,b=async()=>{const{valid:e}=await f.value.validate();e&&(c.value=!0,n.post({url:i.system.role.add_user,params:{roleId:p.role_id,username:_.value}}).then((()=>{m.value=!1,y("callback")})).finally((()=>{c.value=!1})))};return(e,n)=>{const i=l("v-btn"),d=l("v-text-field"),v=l("v-card-text"),p=l("v-spacer"),y=l("v-btn-text"),k=l("v-card-actions"),g=l("v-card"),h=l("v-form"),x=l("v-dialog");return a(),t(o,null,[r(i,{color:"blue-lighten-1",text:"添加用户",onClick:n[0]||(n[0]=e=>m.value=!0)}),r(x,{modelValue:m.value,"onUpdate:modelValue":n[4]||(n[4]=e=>m.value=e),"max-width":"300"},{default:s((()=>[r(h,{class:"form",onSubmit:n[3]||(n[3]=u((()=>{}),["prevent"])),ref_key:"form",ref:f},{default:s((()=>[r(g,null,{default:s((()=>[r(v,null,{default:s((()=>[r(d,{label:"用户名",rules:[e.$validator.required],modelValue:_.value,"onUpdate:modelValue":n[1]||(n[1]=e=>_.value=e)},null,8,["rules","modelValue"])])),_:1}),r(k,null,{default:s((()=>[r(p),r(y,{text:"取消",onClick:n[2]||(n[2]=e=>m.value=!1)}),r(y,{color:"primary",disabled:c.value,loading:c.value,text:"添加",onClick:b},null,8,["disabled","loading"])])),_:1})])),_:1})])),_:1},512)])),_:1},8,["modelValue"])],64)}}},p={__name:"RoleUsers",setup(u){const p=d(),{id:y}=p.query,b=v(),k=e(!1),g=e([]),h=()=>{k.value=!0,n.get({url:i.system.role.users,params:{roleId:y}}).then((e=>{g.value=e})).finally((()=>{k.value=!1}))};return c((()=>{b.commit("update_sider_active","/system/roles"),h()})),(e,u)=>{const d=l("v-btn-text"),v=l("v-btn-link"),c=l("v-data-table-virtual");return a(),t(o,null,[r(d,{style:{"margin-right":"10px"},onClick:u[0]||(u[0]=l=>e.$router.push("/system/roles")),icon:"mdi-chevron-left"}),r(f,{onCallback:h,role_id:m(y)},null,8,["role_id"]),r(c,{loading:k.value,headers:[{title:"用户名",key:"username",sortable:!1},{key:"actions",width:100,align:"center",sortable:!1}],items:g.value},{"item.actions":s((({item:e})=>[r(v,{onClick:l=>{return a=e.id,void _({message:"确定要删除吗？"}).then((()=>{k.value=!0,n.delete({url:i.system.role.del_user,data:{userId:a}}).then((()=>{h()})).finally((()=>{k.value=!1}))})).catch((()=>{}));var a},text:"删除"},null,8,["onClick"])])),_:1},8,["loading","items"])],64)}}};export{p as default};
