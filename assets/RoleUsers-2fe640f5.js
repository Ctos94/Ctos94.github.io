import{_ as v,A as _,r as e,o as f,e as y,w as n,b as t,v as $,f as q,c as C,F as U}from"./index-3676d8ee.js";const V={data(){return{loading:!1,visible:!1,username:""}},props:{role_id:{type:String,required:!0}},methods:{async submit(){const{valid:l}=await this.$refs.form.validate();l&&(this.loading=!0,this.$request.post({url:_.system.role.add_user,params:{roleId:this.role_id,username:this.username}}).then(()=>{this.visible=!1,this.$emit("callback")}).finally(()=>{this.loading=!1}))}}};function w(l,s,b,h,o,a){const d=e("v-btn"),u=e("v-text-field"),c=e("v-card-text"),m=e("v-spacer"),i=e("v-btn-text"),p=e("v-card-actions"),g=e("v-card"),x=e("v-form"),k=e("v-dialog");return f(),y(k,{modelValue:o.visible,"onUpdate:modelValue":s[3]||(s[3]=r=>o.visible=r),"max-width":"300"},{activator:n(({props:r})=>[t(d,$({color:"blue-lighten-1",text:"添加用户"},r),null,16)]),default:n(()=>[t(x,{class:"form",onSubmit:s[2]||(s[2]=q(()=>{},["prevent"])),ref:"form"},{default:n(()=>[t(g,null,{default:n(()=>[t(c,null,{default:n(()=>[t(u,{label:"用户名",rules:[l.$validator.required],modelValue:o.username,"onUpdate:modelValue":s[0]||(s[0]=r=>o.username=r)},null,8,["rules","modelValue"])]),_:1}),t(p,null,{default:n(()=>[t(m),t(i,{text:"取消",onClick:s[1]||(s[1]=r=>o.visible=!1)}),t(i,{color:"primary",disabled:o.loading,loading:o.loading,text:"保存",onClick:a.submit},null,8,["disabled","loading","onClick"])]),_:1})]),_:1})]),_:1},512)]),_:1},8,["modelValue"])}const R=v(V,[["render",w]]),B={data(){return{loading:!1,tableHeaders:[{title:"用户名",key:"username",sortable:!1},{key:"actions",width:100,align:"center",sortable:!1}],users:[]}},components:{RoleUserDialog:R},mounted(){this.$store.commit("update_sider_active","/system/roles"),this.requestUsers()},methods:{requestUsers(){this.loading=!0,this.$request.get({url:_.system.role.users,params:{roleId:this.$route.query.id}}).then(l=>{this.users=l}).finally(()=>{this.loading=!1})},del(l){this.$confirm({message:"确定要删除吗？"}).then(()=>{this.$request.delete({url:_.system.role.del_user,data:{userId:l}}).then(()=>{this.requestUsers()})}).catch(()=>{})}}};function D(l,s,b,h,o,a){const d=e("v-btn-text"),u=e("RoleUserDialog"),c=e("v-btn-link"),m=e("v-data-table-virtual");return f(),C(U,null,[t(d,{style:{"margin-right":"10px"},onClick:s[0]||(s[0]=i=>this.$router.push("/system/roles")),icon:"mdi-chevron-left"}),t(u,{onCallback:a.requestUsers,role_id:this.$route.query.id},null,8,["onCallback","role_id"]),t(m,{headers:o.tableHeaders,items:o.users},{"item.actions":n(({item:i})=>[t(c,{onClick:p=>a.del(i.id),text:"删除"},null,8,["onClick"])]),_:1},8,["headers","items"])],64)}const A=v(B,[["render",D]]);export{A as default};
