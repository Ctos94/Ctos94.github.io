import{_ as g,A as h,r,o as f,e as y,w as e,b as t,a as $,h as k,t as q,v as w,l as A}from"./index-d815b49d.js";import{P as L}from"./PriceFormat-c4fb6e11.js";import{_ as v}from"./Chart-e2caa004.js";import{f as b}from"./common-1a584e15.js";const N={components:{Chart:v},props:{year:{default:null}},data(){return{}},mounted(){},methods:{request:function(){let a=this.$refs.chart.chart;this.$request.get({url:h.bill.statistic.month,params:{year:this.year},loading:{target:"#chart"}}).then(c=>{let i=c.map(n=>n.price);a.setOption({tooltip:{trigger:"axis",formatter:function(n,s,m){return`${n[0].axisValue}月: ${b(n[0].data)}`}},xAxis:{type:"category",data:[1,2,3,4,5,6,7,8,9,10,11,12]},yAxis:{type:"value"},series:[{data:i,type:"line",markLine:{silent:!0,lineStyle:{color:"rgba(193, 65, 65, 1)"},data:[{type:"average",name:"Avg"}]}}]})})}},watch:{year:function(a){this.request()}}};function S(a,c,i,n,s,m){const l=r("v-card-title"),_=v,o=r("v-card-text"),u=r("v-card"),d=r("v-sheet");return f(),y(d,{id:"chart",border:"",rounded:""},{default:e(()=>[t(u,{flat:""},{default:e(()=>[t(l,null,{default:e(()=>[$(" 月支出 ")]),_:1}),t(o,null,{default:e(()=>[t(_,{ref:"chart"},null,512)]),_:1})]),_:1})]),_:1})}const B=g(N,[["render",S]]);const F={components:{Chart:v},props:{year:{default:null}},data(){return{}},mounted(){},methods:{request:function(){let a=this.$refs.chart.chart;this.$request.get({url:h.bill.statistic.classify,params:{year:this.year},loading:{target:"#pie_chart"}}).then(c=>{let i=c.map(n=>({name:n.tag,value:n.price}));a.setOption({tooltip:{trigger:"item",formatter:function(n,s,m){return`${n.name}: ${b(n.value)} (${n.percent}%)`}},series:[{type:"pie",radius:["40%","70%"],itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},data:i}]})})}},watch:{year:function(a){this.request()}}};function O(a,c,i,n,s,m){const l=r("v-card-title"),_=v,o=r("v-card-text"),u=r("v-card"),d=r("v-sheet");return f(),y(d,{id:"pie_chart",border:"",rounded:""},{default:e(()=>[t(u,{flat:""},{default:e(()=>[t(l,null,{default:e(()=>[$("分类支出")]),_:1}),t(o,null,{default:e(()=>[t(_,{ref:"chart"},null,512)]),_:1})]),_:1})]),_:1})}const T=g(F,[["render",O],["__scopeId","data-v-84c76b62"]]),z={components:{PriceFormatVue:L,ChartLine:B,ChartPie:T},data(){return{current_year:void 0,years:void 0,price:0}},beforeMount(){this.$store.commit("update_sider_active","/bill/statistics")},mounted(){this.$request.get({url:h.bill.statistic.years,loading:{target:"#statistics"}}).then(a=>{a&&a.length>0&&(this.years=a,this.$nextTick(()=>{this.current_year=this.years[0]}))})},methods:{getPrice:function(){this.$request.get({url:h.bill.statistic.price,params:{year:this.current_year}}).then(a=>{this.price=a||0})}},watch:{current_year:function(a){this.getPrice()}}};function D(a,c,i,n,s,m){const l=r("v-list-item"),_=r("v-select"),o=r("v-sheet"),u=r("PriceFormatVue"),d=r("ChartLine"),x=r("v-col"),C=r("ChartPie"),P=r("v-row");return f(),y(o,{id:"statistics"},{default:e(()=>[t(o,null,{default:e(()=>[t(o,{class:"d-flex align-end"},{default:e(()=>[t(o,{width:"130px"},{default:e(()=>[t(_,{density:"compact",variant:"outlined","hide-details":"",items:s.years,modelValue:s.current_year,"onUpdate:modelValue":c[0]||(c[0]=p=>s.current_year=p)},{selection:e(({item:p})=>[k("span",null,q(p.title)+"年",1)]),item:e(({props:p,item:V})=>[t(l,w(p,{title:`${V.title}年`}),null,16,["title"])]),_:1},8,["items","modelValue"])]),_:1}),this.price?(f(),y(o,{key:0,class:"ml-2"},{default:e(()=>[$("总支出 "),t(u,{size:24,amount:s.price},null,8,["amount"])]),_:1})):A("",!0)]),_:1}),t(P,{class:"mt-0"},{default:e(()=>[t(x,{cols:"7",class:"pr-0"},{default:e(()=>[t(d,{year:s.current_year},null,8,["year"])]),_:1}),t(x,{cols:"5"},{default:e(()=>[t(C,{year:s.current_year},null,8,["year"])]),_:1})]),_:1})]),_:1})]),_:1})}const W=g(z,[["render",D]]);export{W as default};
