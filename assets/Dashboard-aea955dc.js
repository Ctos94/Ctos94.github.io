import{_ as w,r as a,o as _,e as b,w as o,b as n,h as d,a as x,t as y,c as F,F as V,l as C,m as N,A as k,n as q}from"./index-3676d8ee.js";/* empty css                  *//* empty css                 *//* empty css                  */import{P}from"./PriceFormat-106b766d.js";import{_ as $}from"./Chart-fba5a41c.js";import{f as L}from"./common-1a584e15.js";const O={components:{PriceFormat:P},props:{data:{type:Object}},data(){return{date:void 0}},computed:{date_:{get(){return this.date||new Date(this.data.year,this.data.month-1)},set(e){this.$emit("dateChange",e.getFullYear(),e.getMonth()+1),this.date=e}}}},R={class:"d-flex"},T={class:"ml-2"},Y={class:"d-flex mt-4"},z={class:"ml-2"};function A(e,s,t,p,r,g){const i=a("PriceFormat"),m=N,c=a("v-icon"),u=a("v-card-text"),h=a("v-card"),f=a("v-sheet");return _(),b(f,{border:"",rounded:""},{default:o(()=>[n(h,{flat:""},{default:o(()=>[n(u,null,{default:o(()=>[d("div",R,[d("div",null,[x(" 总支出 "),n(i,{class:"font-weight-black",size:24,amount:t.data.priceTotal},null,8,["amount"])]),d("div",T,[x(y(t.data.year)+"年总支出 ",1),n(i,{class:"font-weight-black",size:24,amount:t.data.yearPriceTotal},null,8,["amount"])])]),d("div",Y,[d("div",null,[n(m,{modelValue:g.date_,"onUpdate:modelValue":s[0]||(s[0]=l=>g.date_=l),type:"month",placeholder:"选择月",clearable:!1,format:"YYYY年M月",class:"date-picker"},null,8,["modelValue"])]),d("div",z,[x(" 支出共计"+y(t.data.monthCount)+"笔，合计 ",1),n(i,{class:"font-weight-black mr-2",size:24,amount:t.data.monthPrice},null,8,["amount"]),t.data.compare?(_(),F(V,{key:0},[x(" 相较"+y(t.data.month==1?12:t.data.month-1)+"月 ",1),n(c,{style:{margin:"0 -10px 0 -10px","font-size":"30px"},color:t.data.compare>0?"red-darken-1":"green-darken-1",icon:t.data.compare>0?"mdi-triangle-small-up":"mdi-triangle-small-down"},null,8,["color","icon"]),x(" "+y(t.data.compare)+"% ",1)],64)):C("",!0)])])]),_:1})]),_:1})]),_:1})}const B=w(O,[["render",A],["__scopeId","data-v-65cb857b"]]),S={components:{Chart:$,PriceFormat:P},props:{year:{type:Number,default:0},month:{type:Number,default:0}},computed:{changeData(){const{year:e,month:s}=this;return{year:e,month:s}}},data(){return{visible:!1,bills:[],tableTitle:"",tableLoading:!1}},mounted(){this.$refs.chart.chart.on("click",e=>{if(e)if(Number(e.value)===0)this.$message.error("当日没有消费产生");else{let s=`${this.year}-${this.month<10?0+String(this.month):this.month}-${e.name<10?0+String(e.name):e.name}`;this.tableTitle=`${s}支出`,this.bills=[],this.tableLoading=!0,this.$request.get({url:k.bill.list.by_date,params:{date:s}}).then(t=>{this.bills=t}).finally(()=>{this.tableLoading=!1}),this.visible=!0}})},methods:{request:function(){if(!this.year||!this.month)return;let e=[],s=[];this.$request.get({url:k.bill.dashboard.compared,params:{year:this.year,month:this.month},loading:{target:"#bill_line"}}).then(t=>{t.forEach(p=>{e.push(p.unit),s.push(p.price)})}).finally(()=>{this.$refs.chart.chart.setOption({tooltip:{trigger:"axis",formatter:function(t,p,r){return`${t[0].axisValue}日: ${L(t[0].data)}`}},xAxis:{type:"category",data:e},yAxis:{type:"value"},series:[{data:s,type:"line",markLine:{silent:!0,lineStyle:{color:"rgba(193, 65, 65, 1)"},data:[{type:"average"}]}}]})})}},watch:{changeData(e){this.request()}}};function j(e,s,t,p,r,g){const i=$,m=a("v-card-text"),c=a("v-card"),u=a("PriceFormat"),h=a("v-data-table-virtual"),f=a("v-dialog"),l=a("v-sheet");return _(),b(l,{id:"bill_line",border:"",rounded:""},{default:o(()=>[n(c,{flat:"",title:t.year&&t.month?`${t.year}年${t.month}月支出对比`:"月支出对比"},{default:o(()=>[n(m,null,{default:o(()=>[n(i,{ref:"chart"},null,512)]),_:1})]),_:1},8,["title"]),n(f,{modelValue:r.visible,"onUpdate:modelValue":s[0]||(s[0]=v=>r.visible=v),width:"80%"},{default:o(()=>[n(c,{title:r.tableTitle},{default:o(()=>[n(m,null,{default:o(()=>[n(h,{loading:r.tableLoading,headers:[{title:"交易方",key:"payee",width:280,sortable:!1},{title:"支出项",key:"detail",sortable:!1},{title:"金额",key:"price",width:100,sortable:!1}],items:r.bills},{"item.price":o(({item:v})=>[n(u,{amount:v.price},null,8,["amount"])]),_:1},8,["loading","items"])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])]),_:1})}const E=w(S,[["render",j]]),M={components:{PriceFormat:P},props:{year:{type:Number,default:0},month:{type:Number,default:0}},data(){return{rank:[]}},computed:{changeData(){const{year:e,month:s}=this;return{year:e,month:s}}},methods:{request:function(){!this.year||!this.month||this.$request.get({url:k.bill.dashboard.rank,params:{year:this.year,month:this.month},loading:{target:"#rank"}}).then(e=>{this.rank=e})}},watch:{changeData(e){this.request()}}},U={class:"d-flex justify-space-between"},I={class:"text-overflow pr-8"},G={class:"font-12 text-grey"};function H(e,s,t,p,r,g){const i=a("PriceFormat"),m=a("v-list-item"),c=a("v-list"),u=a("v-card-text"),h=a("v-card"),f=a("v-sheet");return _(),b(f,{id:"rank",border:"",rounded:""},{default:o(()=>[n(h,{flat:"",title:t.year&&t.month?`${t.year}年${t.month}月支出排行`:"月支出排行"},{default:o(()=>[n(u,null,{default:o(()=>[n(c,{class:"pa-0"},{default:o(()=>[(_(!0),F(V,null,q(r.rank,l=>(_(),b(m,{class:"pa-0",key:l.id},{default:o(()=>[d("div",U,[d("span",I,y(l.detail),1),n(i,{amount:l.price},null,8,["amount"])]),d("div",G,y(l.date),1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1},8,["title"])]),_:1})}const J=w(M,[["render",H]]),K={components:{PriceFormat:P},props:{year:{type:Number,default:0},month:{type:Number,default:0}},data(){return{classifies:[]}},computed:{changeData(){const{year:e,month:s}=this;return{year:e,month:s}}},methods:{request:function(){!this.year||!this.month||this.$request.get({url:k.bill.dashboard.classify,params:{year:this.year,month:this.month},loading:{target:"#classify"}}).then(e=>{this.classifies=e})}},watch:{changeData(e){this.request()}}},Q={class:"d-flex justify-space-between"};function W(e,s,t,p,r,g){const i=a("PriceFormat"),m=a("v-progress-linear"),c=a("v-list-item"),u=a("v-list"),h=a("v-card-text"),f=a("v-card"),l=a("v-sheet");return _(),b(l,{id:"classify",border:"",rounded:""},{default:o(()=>[n(f,{flat:"",title:t.year&&t.month?`${t.year}年${t.month}月支出分类`:"月支出分类"},{default:o(()=>[r.classifies.length?(_(),b(h,{key:0},{default:o(()=>[n(u,{class:"pa-0"},{default:o(()=>[(_(!0),F(V,null,q(r.classifies,(v,D)=>(_(),b(c,{class:"pa-0",key:D},{default:o(()=>[d("div",Q,[d("div",null,y(v.tag)+y(v.percentage)+"%",1),n(i,{amount:v.price},null,8,["amount"])]),n(m,{color:"blue-lighten-1","model-value":v.percentage},null,8,["model-value"])]),_:2},1024))),128))]),_:1})]),_:1})):C("",!0)]),_:1},8,["title"])]),_:1})}const X=w(K,[["render",W]]),Z={components:{OverView:B,ChartLine:E,Rank:J,Classify:X},data(){return{data:{year:null,month:null}}},beforeMount(){this.$store.commit("update_sider_active","/bill/dashboard")},mounted(){this.fRequest()},methods:{fRequest:function(e,s){this.$request.get({url:k.bill.dashboard.overview,params:{year:e,month:s},loading:{target:"#overview"}}).then(t=>{this.data=t})}}};function tt(e,s,t,p,r,g){const i=a("OverView"),m=a("ChartLine"),c=a("v-col"),u=a("Classify"),h=a("Rank"),f=a("v-row"),l=a("v-sheet");return _(),b(l,null,{default:o(()=>[n(f,null,{default:o(()=>[n(c,{cols:"8",class:"pr-0"},{default:o(()=>[n(i,{id:"overview",class:"mb-2",data:r.data,onDateChange:g.fRequest},null,8,["data","onDateChange"]),n(m,{year:r.data.year,month:r.data.month},null,8,["year","month"])]),_:1}),n(c,{cols:"4"},{default:o(()=>[n(u,{class:"mb-2",year:r.data.year,month:r.data.month},null,8,["year","month"]),n(h,{year:r.data.year,month:r.data.month},null,8,["year","month"])]),_:1})]),_:1})]),_:1})}const it=w(Z,[["render",tt]]);export{it as default};
